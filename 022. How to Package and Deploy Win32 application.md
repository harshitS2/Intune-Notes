https://github.com/Microsoft/Microsoft-Win32-Content-Prep-Tool

---

# Lecture Notes: Packaging and Deploying Win32 Applications Using Microsoft Intune

## Overview

* **Topic:** Packaging and deploying **Win32 applications** to Windows devices using Microsoft Intune
* **Deployment Type:** **Win32 App (Recommended modern approach)**
* **Example Used:** VLC Media Player
* **Target OS:** Windows 10
* **Result:** Win32 application is packaged, uploaded, deployed, and monitored successfully

---

## Why Use Win32 App Deployment?

* Supports both:

  * **32-bit**
  * **64-bit** applications
* Works for:

  * EXE-based installers
  * MSI installers
  * Apps with multiple files/folders
* Supports advanced features:

  * Detection rules
  * Dependencies
  * Supersedence
  * Custom install/uninstall logic

> ✅ **Win32 app deployment is the recommended method** over LOB apps for enterprise environments.

---

## Key Limitation to Understand

* Win32 apps **cannot be uploaded directly**
* Apps must first be packaged into:

  * **`.intunewin`** format
* Packaging is done using:

  * **Microsoft Win32 Content Prep Tool**

---

## Tool Required: Microsoft Win32 Content Prep Tool

* Downloaded from **GitHub**
https://github.com/Microsoft/Microsoft-Win32-Content-Prep-Tool
* Purpose:

  * Compresses and encrypts app files
  * Generates `.intunewin` package
  * Extracts metadata required by Intune

---

## Scenario Demonstrated

* Application: **VLC Media Player**
* Installer type: **EXE**
* Assignment type: **Required**
* Target: Windows 10 device group
* Deployment context: **System**

---

## Preparation: Folder Structure

Three folders were created on `C:\` drive:

1. **VLC**

   * Contains application installer (`vlc.exe`)
2. **IntuneApps**

   * Stores generated `.intunewin` file
3. **IntuneWinAppUtil**

   * Stores Win32 Content Prep Tool

---

## Step 1: Download Win32 Content Prep Tool

1. Search **Win32 Content Prep Tool** on Google
2. Open the **GitHub** repository
3. Click **Code → Download ZIP**
4. Extract contents
5. Copy files to:

   * `C:\IntuneWinAppUtil`

---

## Step 2: Create the `.intunewin` Package

### Open Elevated Terminal

1. Right-click **Start**
2. Select **Windows Terminal (Admin)**

---

### Navigate to Tool Folder

```plaintext
cd C:\IntuneWinAppUtil
```

---

### Run the Tool

```plaintext
IntuneWinAppUtil.exe
```

---

### Provide Required Inputs

* **Source folder:**
  `C:\VLC`

* **Setup file:**
  `vlc.exe`

* **Output folder:**
  `C:\IntuneApps`

* **Catalog folder:**
  `N`

---

### Output

* `.intunewin` file created successfully
* Approximate size: ~40 MB
* Stored in `C:\IntuneApps`

---

## Step 3: Upload Win32 App to Intune

### Navigation

1. Sign in to Microsoft Endpoint Manager

   * URL: `https://endpoint.microsoft.com`
2. Go to **Apps**
3. Select **Windows**
4. Click **Add**

---

### Select App Type

* Choose **Windows app (Win32)**
* Click **Select**

---

### Upload App Package

1. Click **Select app package file**
2. Browse to:

   * `C:\IntuneApps`
3. Select `.intunewin` file
4. Click **OK**

---

## Step 4: App Information

* **Name:** VLC Media Player
* **Publisher:** VideoLAN
* **Category:** Optional
* **Logo:** Upload VLC icon

Click **Next**

---

## Step 5: Program Configuration

### Install & Uninstall Commands

* Provide correct silent install and uninstall commands
* These are application-specific

---

### Install Behavior

* **System** (recommended)

  * Runs with administrative privileges
* Use **User** only if app explicitly requires it

---

### Restart Behavior

* **No specific action**

  * VLC does not require restart

---

### Return Codes

* Define success and reboot return codes
* Used by Intune to determine installation outcome

Click **Next**

---

## Step 6: Requirements

* **Architecture:** 64-bit
* **Minimum OS:** Windows 10 21H1
* Other options optional

Click **Next**

---

## Step 7: Detection Rules (Mandatory)

> ❗ Without detection rules, Intune cannot determine install success.

### Detection Rule Used

* **Rule type:** File
* **Path:**
  `C:\Program Files\VideoLAN\VLC`
* **File:**
  `vlc.exe`
* **Detection method:** File exists

✔ If file exists → installation successful

Click **Next**

---

## Step 8: Dependencies (Optional)

* Not configured in this example
* Used when another app must be installed first

Click **Next**

---

## Step 9: Supersedence (Optional / Preview)

* Used to replace or upgrade existing apps
* Not used in this demo

Click **Next**

---

## Step 10: Assignments

### Assignment Type

* **Required**

  * App installs automatically

---

### Group Assignment

1. Click **Add group**
2. Select:

   * `Test-Win-Client`
3. Click **Select**
4. Click **Next**

---

## Step 11: Review and Create

1. Review all settings
2. Click **Create**

---

### Upload Status

* `.intunewin` file uploads to Intune
* Confirmation:

  * **Upload of Intune package finished successfully**

---

## Step 12: Client-Side Installation (Windows 10)

### Manual Sync

1. **Settings → Accounts**
2. **Access work or school**
3. Click **Info → Sync**

---

### Installation Experience

* Notification appears:

  * Downloading VLC Media Player
  * Installing VLC Media Player
* Success notification displayed
* Desktop shortcut created

---

### Verification on Device

* Open **VLC Media Player**
* Run `appwiz.cpl`
* Confirm:

  * VLC installed
  * Installation date = today

---

## Step 13: Monitoring in Intune

### Recommended Monitoring Method

1. Go to **Devices**
2. Select **Windows**
3. Choose target device
4. Under **Monitor → Managed apps**
5. Confirm:

   * VLC Media Player
   * Status: **Installed**

> Device-level monitoring updates faster than app-level reports.

---

## Key Takeaways

* Win32 app deployment is **most powerful and flexible**
* Requires `.intunewin` packaging
* Detection rules are **mandatory**
* Supports enterprise features:

  * Dependencies
  * Supersedence
  * Custom scripts
* Device-level monitoring is more reliable

---

## Summary

* VLC Media Player was packaged using Win32 Content Prep Tool
* `.intunewin` file uploaded to Intune
* App deployed as **Required**
* Installed successfully on Windows 10
* Deployment verified on:

  * Client device
  * Intune Admin Center

---

## Open Questions / Further Study

* Script-based detection rules
* EXE vs MSI handling in Win32 apps
* Supersedence for app upgrades
* Win32 app troubleshooting
* Comparing Win32 apps vs LOB apps

---

**End of Lecture Notes**
