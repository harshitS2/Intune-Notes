
---

# Lecture Notes: Deploying a Windows Update Package Using Microsoft Intune (Win32 App)

## Overview

* **Topic:** Deploying a **specific Windows Update (.MSU)** to Windows 10 devices using Microsoft Intune
* **Deployment Method:** **Win32 App**
* **Target OS:** Windows 10
* **Update Type:** Microsoft Quality Update (KB-based)
* **Result:** Windows update deployed, installed, detected, and monitored successfully

---

## When to Use This Method

Use this approach when:

* You need to deploy **a specific Windows update (KB)**
* Devices are **Intune-managed**
* You want:

  * Controlled deployment
  * Custom install/uninstall logic
  * Accurate detection and reporting

> ⚠️ This method is **not a replacement** for Windows Update Rings.
> It is best for **one-off updates, hotfixes, or emergency patching**.

---

## High-Level Deployment Flow

1. Download `.msu` update
2. Create install & uninstall scripts
3. Package update as `.intunewin`
4. Upload as Win32 app
5. Configure detection using PowerShell
6. Assign as **Required**
7. Monitor installation and reboot

---

## Prerequisites

* Global Administrator or Intune Administrator role
* Windows Update `.MSU` file
* Microsoft Win32 Content Prep Tool
* Windows 10 test device enrolled in Intune

---

## Folder Structure Used

Three folders created on `C:\` drive:

1. **MSUPackage**

   * Contains:

     * `.msu` update file
     * `install.cmd`
     * `uninstall.cmd`

2. **IntuneApps**

   * Stores the generated `.intunewin` file

3. **IntuneWinAppUtil**

   * Stores Microsoft Win32 Content Prep Tool

---

## Step 1: Download the Windows Update

* Download the required update from:

  * **Microsoft Update Catalog**
* Example:

  * `KB502282`
* Store the `.msu` file inside:

  * `C:\MSUPackage`

---

## Step 2: Create Install & Uninstall Scripts

### install.cmd

* Installs the `.msu` update silently
* Uses `wusa.exe`

### uninstall.cmd

* Removes the update if rollback is required
* Uses KB number

> ⚠️ **Important:**
> `.msu`, `install.cmd`, and `uninstall.cmd` **must be in the same folder**

---

## Step 3: Create `.intunewin` Package

### Open Elevated Terminal

1. Right-click **Start**
2. Select **Windows Terminal (Admin)**

---

### Navigate to Win32 Tool Folder

```plaintext
cd C:\IntuneWinAppUtil
```

---

### Run the Tool

```plaintext
IntuneWinAppUtil.exe
```

---

### Provide Inputs

* **Source folder:**
  `C:\MSUPackage`

* **Setup file:**
  `<UpdateName>.msu`

* **Output folder:**
  `C:\IntuneApps`

* **Catalog folder:**
  `N`

---

### Output

* `.intunewin` file created successfully
* Stored in `C:\IntuneApps`

---

## Step 4: Upload Update as Win32 App in Intune

### Navigation

1. Go to **Microsoft Endpoint Manager Admin Center**

   * `https://endpoint.microsoft.com`
2. Select **Apps**
3. Click **Windows**
4. Click **Add**

---

### App Type

* Select **Windows app (Win32)**
* Click **Select**

---

### Upload Package

1. Click **Select app package file**
2. Browse to `C:\IntuneApps`
3. Select `.intunewin`
4. Click **OK**

---

## Step 5: App Information

* **Name:** Windows Update – KB502282
* **Publisher:** Microsoft
* **Description:** Windows Quality Update
* **Category:** Optional

Click **Next**

---

## Step 6: Program Configuration

### Commands

* **Install command:**

  ```plaintext
  install.cmd
  ```

* **Uninstall command:**

  ```plaintext
  uninstall.cmd
  ```

---

### Install Behavior

* **System** (mandatory for updates)

---

### Restart Behavior

* **App install may force a device restart**

  * Required for Windows updates

Click **Next**

---

## Step 7: Requirements

* **Architecture:** 64-bit
* **Minimum OS:** Windows 10 21H1

Click **Next**

---

## Step 8: Detection Rules (PowerShell Script)

### Detection Method

* **Use a custom detection script**

---

### Detection Logic

* PowerShell script checks:

  * Whether the **KB number** is installed
* Script sourced from Microsoft documentation
* Replace KB number as required
* File saved as `.ps1`

---

### Upload Script

1. Click **Browse**
2. Upload `.ps1` file
3. Script content is displayed for verification

Click **Next**

---

## Step 9: Dependencies & Supersedence

* **Dependencies:** Not required
* **Supersedence:** Not configured

Click **Next**

---

## Step 10: Assignments

### Assignment Type

* **Required**

  * Update installs automatically

---

### Target Group

* Device group:

  * `Test-App-Client`

Click **Next**

---

## Step 11: Review & Create

1. Review configuration
2. Click **Create**
3. Wait for upload to complete

✔ App uploaded successfully
✔ App assigned to device group

---

## Step 12: Client-Side Deployment

### Manual Sync

1. **Settings → Accounts**
2. **Access work or school**
3. Click **Info → Sync**

---

### Installation Behavior

* Large update (~700 MB)
* Takes time to download
* Device restart required

---

### User Experience

* Notification:

  * Downloading update
  * Installing update
  * Restart required

---

## Step 13: Verify Installation on Device

### Check Update Status

1. **Settings → Update & Security**
2. Click **View update history**

✔ Update installed successfully
✔ KB number matches deployed update

---

## Step 14: Verify in Intune Admin Center

### App-Level Monitoring

1. Go to **Apps → Windows**
2. Select update package
3. Click **Device install status**

✔ Status: **Installed**

---

### Device-Level Monitoring (Recommended)

1. Go to **Devices → Windows**
2. Select target device
3. Click **Managed apps**

✔ Update listed
✔ Installation completed

---

## Key Takeaways

* Windows updates can be deployed using **Win32 apps**
* `.msu` files must be:

  * Scripted
  * Packaged as `.intunewin`
* PowerShell detection is **mandatory**
* Restart behavior must be planned
* Best suited for:

  * Emergency patches
  * Specific KB deployments

---

## Summary

* Windows update package downloaded
* Packaged using Win32 Content Prep Tool
* Uploaded to Intune as Win32 app
* Installed successfully on Windows 10
* Verified via:

  * Update history
  * Intune monitoring

---

## Best Practices

* Use Update Rings for regular patching
* Use Win32 method for targeted updates only
* Always test in pilot groups
* Document KB numbers clearly
* Expect delayed reporting after reboot

---

**End of Lecture Notes**
